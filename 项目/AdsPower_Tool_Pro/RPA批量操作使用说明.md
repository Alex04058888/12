# AdsPower工具专业版 - RPA批量操作功能使用说明

## 📖 功能概述

RPA批量操作功能是AdsPower工具专业版的核心特性之一，允许用户对多个浏览器环境同时执行自动化操作，大大提高工作效率。

## 🚀 主要特性

### ✨ 核心功能
- **多环境批量操作**: 同时对多个AdsPower环境执行RPA任务
- **多种执行模式**: 支持顺序、并行、随机三种执行模式
- **实时进度监控**: 可视化显示执行进度和状态
- **失败重试机制**: 自动重试失败的环境或手动重试
- **结果导出**: 支持导出详细的执行结果和日志

### 🎯 执行模式
1. **顺序执行**: 按顺序逐个执行环境，稳定可靠
2. **并行执行**: 同时执行多个环境，提高效率
3. **随机执行**: 随机顺序执行，模拟真实用户行为

### 📋 内置流程模板
- **基础网页操作**: 页面导航、点击、输入等基础操作
- **数据采集流程**: 网页数据提取和保存
- **表单填写流程**: 自动填写表单并提交
- **页面截图流程**: 批量截图保存

## 🔧 使用方法

### 方法一：从环境列表右键菜单
1. 在环境管理页面选择要操作的环境
2. 右键点击选中的环境
3. 选择"🤖 RPA批量操作"

### 方法二：从工具菜单
1. 点击菜单栏"工具"
2. 选择"🤖 RPA批量操作"
3. 如果没有选中环境，会提示先选择环境

## 📊 操作界面说明

### 批量配置选项卡
- **选中的环境**: 显示当前选择的环境列表
- **执行模式**: 选择顺序、并行或随机执行
- **并行数量**: 设置并行执行的最大环境数（1-10）
- **环境间延迟**: 设置环境间的延迟时间（0-60秒）
- **错误处理**: 选择遇到错误时的处理方式
- **RPA流程**: 选择预设模板或加载自定义流程文件

### 执行监控选项卡
- **执行进度**: 实时显示总体执行进度
- **状态信息**: 显示当前状态、环境、成功/失败数量
- **执行日志**: 实时显示详细的执行日志
- **日志操作**: 支持清空日志和保存日志到文件

### 结果查看选项卡
- **执行统计**: 显示总环境数、成功率、执行时间等统计信息
- **详细结果**: 表格形式显示每个环境的执行结果
- **结果操作**: 支持导出结果和重试失败的环境

## 🤖 RPA流程格式

### 基本结构
```json
{
  "name": "流程名称",
  "steps": [
    {
      "action": "操作类型",
      "参数1": "值1",
      "参数2": "值2"
    }
  ]
}
```

### 支持的操作类型

#### 1. 页面导航
```json
{
  "action": "navigate",
  "url": "https://example.com"
}
```

#### 2. 等待
```json
{
  "action": "wait",
  "seconds": 3
}
```

#### 3. 点击元素
```json
{
  "action": "click",
  "selector": {
    "type": "id",
    "value": "button-id"
  }
}
```

#### 4. 输入文本
```json
{
  "action": "input",
  "selector": {
    "type": "name",
    "value": "username"
  },
  "text": "输入的文本"
}
```

#### 5. 等待元素出现
```json
{
  "action": "wait_for_element",
  "selector": {
    "type": "class",
    "value": "loading"
  }
}
```

#### 6. 提取文本
```json
{
  "action": "extract_text",
  "selector": {
    "type": "xpath",
    "value": "//h1[@class='title']"
  },
  "save_to": "page_title"
}
```

#### 7. 页面截图
```json
{
  "action": "screenshot",
  "filename": "screenshot.png"
}
```

#### 8. 页面滚动
```json
{
  "action": "scroll",
  "direction": "down",
  "pixels": 500
}
```

### 选择器类型
- `id`: 通过ID选择元素
- `name`: 通过name属性选择元素
- `class`: 通过class选择元素
- `xpath`: 通过XPath选择元素
- `css`: 通过CSS选择器选择元素

### 变量替换
在流程中可以使用变量，格式为 `{{变量名}}`：
- `{{env_id}}`: 当前环境ID
- `{{username}}`: 用户名
- `{{email}}`: 邮箱
- `{{target_url}}`: 目标URL

## 📝 使用示例

### 示例1：基础网页操作
```json
{
  "name": "基础网页操作示例",
  "steps": [
    {
      "action": "navigate",
      "url": "https://example.com"
    },
    {
      "action": "wait",
      "seconds": 2
    },
    {
      "action": "click",
      "selector": {
        "type": "id",
        "value": "login-button"
      }
    },
    {
      "action": "input",
      "selector": {
        "type": "name",
        "value": "username"
      },
      "text": "{{username}}"
    },
    {
      "action": "input",
      "selector": {
        "type": "name",
        "value": "password"
      },
      "text": "{{password}}"
    },
    {
      "action": "click",
      "selector": {
        "type": "id",
        "value": "submit"
      }
    }
  ]
}
```

### 示例2：数据采集流程
```json
{
  "name": "数据采集示例",
  "steps": [
    {
      "action": "navigate",
      "url": "https://news.example.com"
    },
    {
      "action": "wait_for_element",
      "selector": {
        "type": "class",
        "value": "article-list"
      }
    },
    {
      "action": "extract_text",
      "selector": {
        "type": "css",
        "value": "h1.headline"
      },
      "save_to": "headline"
    },
    {
      "action": "extract_text",
      "selector": {
        "type": "css",
        "value": ".article-content"
      },
      "save_to": "content"
    },
    {
      "action": "screenshot",
      "filename": "{{env_id}}_article.png"
    }
  ]
}
```

## ⚠️ 注意事项

### 使用建议
1. **测试先行**: 在大批量执行前，先用少量环境测试流程
2. **合理设置并行数**: 根据服务器性能和目标网站限制设置合理的并行数量
3. **添加适当延迟**: 在环境间添加适当延迟，避免被目标网站识别为机器人
4. **监控执行过程**: 实时监控执行日志，及时发现和处理问题

### 性能优化
1. **并行执行**: 对于独立的任务，使用并行模式提高效率
2. **批量大小**: 建议单次批量操作不超过50个环境
3. **资源监控**: 注意监控系统资源使用情况
4. **网络稳定**: 确保网络连接稳定，避免执行中断

### 错误处理
1. **失败重试**: 利用重试功能处理临时性错误
2. **日志分析**: 通过执行日志分析失败原因
3. **分批执行**: 对于大量环境，建议分批执行
4. **备份数据**: 重要操作前备份相关数据

## 🔧 高级功能

### 自定义流程文件
1. 创建JSON格式的流程文件
2. 在RPA流程区域点击"📂 加载流程文件"
3. 选择自定义的流程文件

### 结果导出
1. 执行完成后切换到"结果查看"选项卡
2. 点击"📤 导出结果"按钮
3. 选择保存位置，导出JSON格式的详细结果

### 失败重试
1. 在"结果查看"选项卡中查看失败的环境
2. 点击"🔄 重试失败"按钮
3. 系统会自动创建新任务重试失败的环境

## 📞 技术支持

如果在使用过程中遇到问题，请：
1. 查看执行日志获取详细错误信息
2. 检查RPA流程格式是否正确
3. 确认AdsPower客户端正常运行
4. 验证网络连接和目标网站可访问性

---

**AdsPower工具专业版** - 让RPA批量操作更简单、更高效！
